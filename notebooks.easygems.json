{"version":2,"kind":"Notebook","sha256":"d9b430115d95e25fa15dd9ade7082b07f425f92d411ad5c3a614b1612d741f58","slug":"notebooks.easygems","location":"/notebooks/01-easygems.ipynb","dependencies":[],"frontmatter":{"title":"easy.gems for HEALPix Analysis & Visualization","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/healpix-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/projectpythia/healpix-cookbook/blob/main/notebooks/01-easygems.ipynb","edit_url":"https://github.com/projectpythia/healpix-cookbook/edit/main/notebooks/01-easygems.ipynb","thumbnail":"/healpix-cookbook/build/017413bc2a0a2abc303b8562edfce112.png","exports":[{"format":"ipynb","filename":"01-easygems.ipynb","url":"/healpix-cookbook/build/01-easygems-c6cd73528c4e020c6852aff0dfa98903.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/healpix-cookbook/build/017413bc2a0a2abc303b8562edfce112.png","alt":"HEALPix logo","width":"30%","key":"HIUe6buSVR","urlSource":"https://easy.gems.dkrz.de/_images/landing-page-banner.png"}],"key":"c92WSXiNGx"},{"type":"heading","depth":1,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"easy.gems for HEALPix Analysis & Visualization","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"w2cnVX9WI0"}],"identifier":"easy-gems-for-healpix-analysis-visualization","label":"easy.gems for HEALPix Analysis & Visualization","html_id":"easy-gems-for-healpix-analysis-visualization","implicit":true,"key":"DRDHQwq9IP"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In this section, you‚Äôll learn:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jvwPYf2TAu"}],"identifier":"in-this-section-youll-learn","label":"In this section, you‚Äôll learn:","html_id":"in-this-section-youll-learn","implicit":true,"key":"hadone0EM1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Utilizing intake to open a HEALPix data catalog","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"u1PbNb6uSZ"}],"key":"rumt5MDKv5"}],"key":"uUjLOtJRCE"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"XAkkHoiLPZ"},{"type":"inlineCode","value":"healpix","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qIRHrfF1ho"},{"type":"text","value":" package to perform HEALPix operations to look at basic statistics","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RmXjCHUO5W"}],"key":"MPgBRwuE6o"}],"key":"Cw3k4BbDh6"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plotting HEALPix data via easy.gems functionality","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ufNOsBTbgZ"}],"key":"rZbI3pqVtE"}],"key":"fGGV9s7RNt"}],"key":"CGe9dUvWlM"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Related Documentation","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Mm8aBf4hgs"}],"identifier":"related-documentation","label":"Related Documentation","html_id":"related-documentation","implicit":true,"key":"LVfP9bP57H"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starter.html#","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Getting started with hierarchical HEALPix data - easy.gems Documentation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ICzYq6mdrp"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starter.html#","key":"y72Ug5963A"}],"key":"X8iqvrlpnG"}],"key":"RwaFyNuOFY"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/healpix_cartopy.html","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Plotting with cartopy - easy.gems Documentation","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pRvpnYdJhQ"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/healpix_cartopy.html","key":"Ho5SfaJfn0"}],"key":"nJKMTNo1d1"}],"key":"PF2vPDSuDl"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://projectpythia.org/intake-cookbook","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Intake Cookbook","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Sc63WovX3o"}],"urlSource":"https://projectpythia.org/intake-cookbook","key":"jQY57G21hb"}],"key":"H20ZJkuYDT"}],"key":"TTLaopx3Tt"}],"key":"YQOYEgVExt"},{"type":"heading","depth":3,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"MOc8zcnHgf"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"nMO00LtfKr"},{"type":"table","position":{"start":{"line":23,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"TVAVHxkNR9"}],"key":"Oub8pzp3rv"},{"type":"tableCell","header":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"rHY1cTw5EF"}],"key":"qbkp3ZIakN"},{"type":"tableCell","header":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"PZ2so3AmbP"}],"key":"r6bXhQS2EM"}],"key":"xoCq38aX4E"},{"type":"tableRow","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"link","url":"/notebooks/healpix","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"HEALPix overview","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"rmsydhz0H0"}],"urlSource":"00-healpix","dataUrl":"/notebooks.healpix.json","internal":true,"protocol":"file","key":"IKCYNVSgmq"}],"key":"TsJGUXGsCr"},{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"kFToYDy2jh"}],"key":"MGu6F69xcp"},{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[],"key":"KSDTtLy9NH"}],"key":"t3L1hcWxX5"}],"key":"Bc96rufyqb"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"fBaRfMfz4K"}],"key":"YIMQLwrayl"},{"type":"text","value":": 30 minutes","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"WHro4gRbCG"}],"key":"NyojNkOAoU"},{"type":"thematicBreak","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"oGroI5CxJu"}],"key":"xcyivWffTr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Open data catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WnvuGafSXu"}],"identifier":"open-data-catalog","label":"Open data catalog","html_id":"open-data-catalog","implicit":true,"key":"raDJfZqfh1"}],"key":"Z3SCnhmyyU"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"xqheSwFJRO"}],"key":"PpE4WRauC8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If you think that you first need to learn about Intake, Pythia‚Äôs ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"omeiHNypFJ"},{"type":"link","url":"https://projectpythia.org/intake-cookbook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Intake Cookbook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kkTWMwQspH"}],"urlSource":"https://projectpythia.org/intake-cookbook","key":"StnxbwXx7d"},{"type":"text","value":" is a great resource to do so.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qhTCyytxMN"}],"key":"vafGd5zc2b"}],"key":"Sxh5aM7y7D"}],"key":"TXPq8LhVIW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us use the online data catalog from the WCRP‚Äôs Digital Earths Global Hackathon 2025‚Äôs ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TZe44MlDnZ"},{"type":"link","url":"https://github.com/digital-earths-global-hackathon/catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"catalog repository","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cbFQ0dHjki"}],"urlSource":"https://github.com/digital-earths-global-hackathon/catalog","error":true,"key":"iUqK4lkkRn"},{"type":"text","value":" using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PNxQQTJKnz"},{"type":"inlineCode","value":"intake","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i2bqH4bO6t"},{"type":"text","value":" and read the output of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xWGuyzbOE0"},{"type":"inlineCode","value":"ICON","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nfNX92GJSZ"},{"type":"text","value":" simulation run ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jYXXLzk8GI"},{"type":"inlineCode","value":"ngc4008","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YTOyMGqjF6"},{"type":"text","value":", which is stored in the HEALPix format:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PuUGVnw3hs"}],"key":"pAygQMOjX2"}],"key":"okOISbWETW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import intake\n\n# Hackathon data catalogs\ncat_url = \"https://digital-earths-global-hackathon.github.io/catalog/catalog.yaml\"\ncat = intake.open_catalog(cat_url).online\nmodel_run = cat.icon_ngc4008","key":"X2gPQrySHq"},{"type":"output","id":"A5fNMDYEqDXNx48lI8yWI","data":[],"key":"QieA2GmTTB"}],"key":"vRApElgDwk"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"kwJgkIcWB8"}],"key":"Xvn1KkYzT4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We highly recommend checking out the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oGJ6mAj9KB"},{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starter.html#the-catalog","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"easy.gems documentation on HEALPix data catalogs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PccmGtPeMp"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starter.html#the-catalog","key":"pDfA0rM7c9"},{"type":"text","value":" to understand the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UEfL75AfkN"},{"type":"inlineCode","value":"zoom","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AlMDxUjhIx"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m26dAxDOCI"},{"type":"inlineCode","value":"time","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e1jhv8YWNJ"},{"type":"text","value":" parametrization of the model runs in the catalogs. In short, each model run has an independent ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PfUhw0vDvM"},{"type":"inlineCode","value":"Dataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oZAB1BlgJQ"},{"type":"text","value":" for each combination of the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ThGGAynQ44"},{"type":"inlineCode","value":"zoom","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GsQeuWrdnF"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DAZHrFv6J1"},{"type":"inlineCode","value":"time","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J8PNIoSC0I"},{"type":"text","value":" parameters as depicted below (image credit ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m3JumCf1EW"},{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starterhtml#the-catalog","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"easy.gems documentation on HEALPix data catalogs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jCZI2cRl8b"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starterhtml#the-catalog","key":"UuLE1AKsGW"},{"type":"text","value":", and ‚ÄúPT30M‚Äù in this figure should be ‚ÄúPT15M‚Äù, 15 minutes, for the hackathon data we are using here)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HZJaQX10d3"}],"key":"dW6FPuT5RF"}],"key":"w7sdxbQnns"}],"key":"zFo9ORZZgs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"image","url":"/healpix-cookbook/build/044ab28ae681f5d84334a3e152648819.png","alt":"Matplotlib Logo","width":600,"key":"rCAG9hlVET","urlSource":"https://easy.gems.dkrz.de/_images/ds_hierarchy.png"}],"key":"qm8JBTnSfd"}],"key":"R0RK9U1s4W"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Explore datasets","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vY0tSH1oTb"}],"identifier":"explore-datasets","label":"Explore datasets","html_id":"explore-datasets","implicit":true,"key":"fMOqiM1ouC"}],"key":"P7UzD8G2YX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So, the coarsest dataset in this model run would be as follows (Even if we called it without specifying any parameters, i.e. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zipapqjNmJ"},{"type":"inlineCode","value":"model_run.to_dask()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qAtiQIYufk"},{"type":"text","value":", the result would be same as the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JrLS0ymxV5"},{"type":"inlineCode","value":"ds_coarsest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mf047WyEmm"},{"type":"text","value":" below since this model run defaults to the coarsest settings):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iCSUFUjLRz"}],"key":"HhFwi8s1LO"}],"key":"NF42Y6IBPJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_coarsest = model_run(zoom=0, time=\"P1D\").to_dask()\nds_coarsest","key":"Oh8NDEcGzN"},{"type":"output","id":"69oNEwT3DApF6SuQHMUMP","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/intake_xarray/base.py:21: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  'dims': dict(self._ds.dims),\n"},{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 883MB\nDimensions:                              (time: 10958, depth_half: 73,\n                                          cell: 12, level_full: 90,\n                                          soil_depth_water_level: 5,\n                                          depth_full: 72, level_half: 91,\n                                          soil_depth_energy_level: 5, crs: 1)\nCoordinates:\n  * time                                 (time) datetime64[ns] 88kB 2020-01-0...\n  * depth_half                           (depth_half) float32 292B 0.0 ... 5....\n  * level_full                           (level_full) int32 360B 1 2 3 ... 89 90\n  * soil_depth_water_level               (soil_depth_water_level) float32 20B ...\n  * depth_full                           (depth_full) float32 288B 1.0 ... 5....\n  * level_half                           (level_half) int32 364B 1 2 3 ... 90 91\n  * soil_depth_energy_level              (soil_depth_energy_level) float32 20B ...\n  * crs                                  (crs) float32 4B nan\nDimensions without coordinates: cell\nData variables: (12/103)\n    A_tracer_v_to                        (time, depth_half, cell) float32 38MB ...\n    FrshFlux_IceSalt                     (time, cell) float32 526kB ...\n    FrshFlux_TotalIce                    (time, cell) float32 526kB ...\n    Qbot                                 (time, cell) float32 526kB ...\n    Qtop                                 (time, cell) float32 526kB ...\n    Wind_Speed_10m                       (time, cell) float32 526kB ...\n    ...                                   ...\n    vas                                  (time, cell) float32 526kB ...\n    w                                    (time, depth_half, cell) float32 38MB ...\n    wa_phy                               (time, level_half, cell) float32 48MB ...\n    zg                                   (level_full, cell) float32 4kB ...\n    zghalf                               (level_half, cell) float32 4kB ...\n    zos                                  (time, cell) float32 526kB ...","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"6ca78ab4f6832af2eef68de6dbd753a0","path":"/healpix-cookbook/build/6ca78ab4f6832af2eef68de6dbd753a0.html"}}}],"key":"hLPPoCwVm5"}],"key":"S4BpUoXpGJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, let us look at a dataset with finer zoom level still with the coarsest time and another dataset with a finer zoom level and the finest time (which may be useful for daily analyses) dataset:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v60j1r4WcT"}],"key":"VgTOPtLaC6"}],"key":"izJY6WLYt3"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_fine = model_run(zoom=7).to_dask()\nds_fine","key":"nYwoX2fBwG"},{"type":"output","id":"qKBGBCS6F-iYNvxhd0JHv","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/intake_xarray/base.py:21: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  'dims': dict(self._ds.dims),\n"},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 14TB\nDimensions:                              (time: 10958, depth_half: 73,\n                                          cell: 196608, level_full: 90,\n                                          soil_depth_water_level: 5,\n                                          depth_full: 72, level_half: 91,\n                                          soil_depth_energy_level: 5, crs: 1)\nCoordinates:\n  * time                                 (time) datetime64[ns] 88kB 2020-01-0...\n  * depth_half                           (depth_half) float32 292B 0.0 ... 5....\n  * level_full                           (level_full) int32 360B 1 2 3 ... 89 90\n  * soil_depth_water_level               (soil_depth_water_level) float32 20B ...\n  * depth_full                           (depth_full) float32 288B 1.0 ... 5....\n  * level_half                           (level_half) int32 364B 1 2 3 ... 90 91\n  * soil_depth_energy_level              (soil_depth_energy_level) float32 20B ...\n  * crs                                  (crs) float32 4B nan\nDimensions without coordinates: cell\nData variables: (12/103)\n    A_tracer_v_to                        (time, depth_half, cell) float32 629GB ...\n    FrshFlux_IceSalt                     (time, cell) float32 9GB ...\n    FrshFlux_TotalIce                    (time, cell) float32 9GB ...\n    Qbot                                 (time, cell) float32 9GB ...\n    Qtop                                 (time, cell) float32 9GB ...\n    Wind_Speed_10m                       (time, cell) float32 9GB ...\n    ...                                   ...\n    vas                                  (time, cell) float32 9GB ...\n    w                                    (time, depth_half, cell) float32 629GB ...\n    wa_phy                               (time, level_half, cell) float32 784GB ...\n    zg                                   (level_full, cell) float32 71MB ...\n    zghalf                               (level_half, cell) float32 72MB ...\n    zos                                  (time, cell) float32 9GB ...","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"e986ca74ed5b0bfec2c90e636e279d66","path":"/healpix-cookbook/build/e986ca74ed5b0bfec2c90e636e279d66.html"}}}],"key":"yrqSJNGurS"}],"key":"tms0iuQrBn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_finesttime = model_run(zoom=6, time=\"PT15M\").to_dask()\nds_finesttime","key":"fSQdD8HXcF"},{"type":"output","id":"4IkjCEU_pV159oGbnv-Re","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/intake_xarray/base.py:21: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  'dims': dict(self._ds.dims),\n"},{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 1TB\nDimensions:  (time: 1051968, cell: 49152, crs: 1)\nCoordinates:\n  * time     (time) datetime64[ns] 8MB 2020-01-01T00:15:00 ... 2050-01-01\n  * crs      (crs) float32 4B nan\nDimensions without coordinates: cell\nData variables:\n    pr       (time, cell) float32 207GB ...\n    qv2m     (time, cell) float32 207GB ...\n    rlut     (time, cell) float32 207GB ...\n    rsds     (time, cell) float32 207GB ...\n    sfcwind  (time, cell) float32 207GB ...\n    tas      (time, cell) float32 207GB ...","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n  line-height: 1.6;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-obj-name,\n.xr-group-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-group-name::before {\n  content: \"üìÅ\";\n  padding-right: 0.3em;\n}\n\n.xr-group-name,\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n  margin-block-start: 0;\n  margin-block-end: 0;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n  margin: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-top: 4px;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-group-box {\n  display: inline-grid;\n  grid-template-columns: 0px 20px auto;\n  width: 100%;\n}\n\n.xr-group-box-vline {\n  grid-column-start: 1;\n  border-right: 0.2em solid;\n  border-color: var(--xr-border-color);\n  width: 0px;\n}\n\n.xr-group-box-hline {\n  grid-column-start: 2;\n  grid-row-start: 1;\n  height: 1em;\n  width: 20px;\n  border-bottom: 0.2em solid;\n  border-color: var(--xr-border-color);\n}\n\n.xr-group-box-contents {\n  grid-column-start: 3;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1TB\nDimensions:  (time: 1051968, cell: 49152, crs: 1)\nCoordinates:\n  * time     (time) datetime64[ns] 8MB 2020-01-01T00:15:00 ... 2050-01-01\n  * crs      (crs) float32 4B nan\nDimensions without coordinates: cell\nData variables:\n    pr       (time, cell) float32 207GB ...\n    qv2m     (time, cell) float32 207GB ...\n    rlut     (time, cell) float32 207GB ...\n    rsds     (time, cell) float32 207GB ...\n    sfcwind  (time, cell) float32 207GB ...\n    tas      (time, cell) float32 207GB ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-39d6df3f-e46c-48bb-9cde-f8180f439f58' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-39d6df3f-e46c-48bb-9cde-f8180f439f58' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1051968</li><li><span>cell</span>: 49152</li><li><span class='xr-has-index'>crs</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f0293898-ad32-4f18-baab-7ec6d12284cb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f0293898-ad32-4f18-baab-7ec6d12284cb' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-01-01T00:15:00 ... 2050-01-01</div><input id='attrs-b00ab668-89b2-450d-8440-cc7f2cafa1c6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b00ab668-89b2-450d-8440-cc7f2cafa1c6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e2043e0-a5be-4874-8b34-0caaf9278f06' class='xr-var-data-in' type='checkbox'><label for='data-7e2043e0-a5be-4874-8b34-0caaf9278f06' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-01-01T00:15:00.000000000&#x27;, &#x27;2020-01-01T00:30:00.000000000&#x27;,\n       &#x27;2020-01-01T00:45:00.000000000&#x27;, ..., &#x27;2049-12-31T23:30:00.000000000&#x27;,\n       &#x27;2049-12-31T23:45:00.000000000&#x27;, &#x27;2050-01-01T00:00:00.000000000&#x27;],\n      shape=(1051968,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>crs</span></div><div class='xr-var-dims'>(crs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan</div><input id='attrs-7c02f714-bba7-45f5-8a7b-d279616d0788' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c02f714-bba7-45f5-8a7b-d279616d0788' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-637c547c-bccd-4081-9614-a75e61c07074' class='xr-var-data-in' type='checkbox'><label for='data-637c547c-bccd-4081-9614-a75e61c07074' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping_name :</span></dt><dd>healpix</dd><dt><span>healpix_nside :</span></dt><dd>64</dd><dt><span>healpix_order :</span></dt><dd>nest</dd></dl></div><div class='xr-var-data'><pre>array([nan], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8795de5d-e705-45d8-a6f3-ebb0bc7e3bf0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8795de5d-e705-45d8-a6f3-ebb0bc7e3bf0' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pr</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7114d0f6-78dc-4a5e-972e-27919574d84a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7114d0f6-78dc-4a5e-972e-27919574d84a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c7d51370-370f-4090-a910-e84e991d50bd' class='xr-var-data-in' type='checkbox'><label for='data-c7d51370-370f-4090-a910-e84e991d50bd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>precipitation flux</dd><dt><span>units :</span></dt><dd>kg m-2 s-1</dd><dt><span>vgrid :</span></dt><dd>surface</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qv2m</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-53cfa9cf-566d-4084-bf2b-4794d9069a91' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-53cfa9cf-566d-4084-bf2b-4794d9069a91' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71984c81-2398-447a-87d4-51b14c4442de' class='xr-var-data-in' type='checkbox'><label for='data-71984c81-2398-447a-87d4-51b14c4442de' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>specific humidity in 2m</dd><dt><span>units :</span></dt><dd>kg kg-1</dd><dt><span>vgrid :</span></dt><dd>height_2m</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rlut</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2518f019-a513-48f6-a737-9159780e85eb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2518f019-a513-48f6-a737-9159780e85eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-766f0696-d4f1-471a-98ba-63546c5b5204' class='xr-var-data-in' type='checkbox'><label for='data-766f0696-d4f1-471a-98ba-63546c5b5204' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>toa outgoing longwave radiation</dd><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>vgrid :</span></dt><dd>toa</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rsds</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-41ff3e9c-384d-4f31-9572-0c57791acf19' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-41ff3e9c-384d-4f31-9572-0c57791acf19' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0c94a56-db9f-400b-a21e-31617d907d7e' class='xr-var-data-in' type='checkbox'><label for='data-d0c94a56-db9f-400b-a21e-31617d907d7e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>surface downwelling shortwave radiation</dd><dt><span>standard_name :</span></dt><dd>surface_downwelling_shortwave_flux_in_air</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>vgrid :</span></dt><dd>surface</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sfcwind</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6f38eee7-f5ac-496c-9e8f-2282de0bf7a9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6f38eee7-f5ac-496c-9e8f-2282de0bf7a9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-524f4bc8-897e-4b21-bcbd-a192f1a87678' class='xr-var-data-in' type='checkbox'><label for='data-524f4bc8-897e-4b21-bcbd-a192f1a87678' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>10m windspeed</dd><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>vgrid :</span></dt><dd>height_10m</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5264dfef-cae8-40bd-834c-cc1fd1162f8a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5264dfef-cae8-40bd-834c-cc1fd1162f8a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-83759d41-57ab-46c1-99d1-b16720c9cadf' class='xr-var-data-in' type='checkbox'><label for='data-83759d41-57ab-46c1-99d1-b16720c9cadf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>temperature in 2m</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>vgrid :</span></dt><dd>height_2m</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li></ul></div></li></ul></div></div>","content_type":"text/html"}}}],"key":"IjAbu73MEp"}],"key":"LIBqrmnoA8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HEALPix basic stats with the","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kNhTR7P2YL"},{"type":"inlineCode","value":"healpix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WaadyPso4N"},{"type":"text","value":" package","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JccHGuSPrX"}],"identifier":"healpix-basic-stats-with-thehealpix-package","label":"HEALPix basic stats with thehealpix package","html_id":"healpix-basic-stats-with-thehealpix-package","implicit":true,"key":"olWXrvhOot"}],"key":"Oliy57q4kJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us look at the global and Boulder, CO, USA temperature averages for a 3-year time-slice of the whole dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mbEMB99kBG"}],"key":"dCcLMs5530"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this, we will first need to define a few HEALPix helper functions to get the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DcAzngZWXJ"},{"type":"inlineCode","value":"nest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IC9Hhnw1Cf"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pm1v6RtP7A"},{"type":"inlineCode","value":"nside","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jlQ9zUojkU"},{"type":"text","value":" values from the dataset, then find the HEALPix pixel that Boulder coords fall in, and finally plot those temporal averages using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kwoe2czDki"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N0UJwT7Ya7"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jxSzNvTbDm"}],"key":"xw3Km3B73U"}],"key":"hYPGsg5Qhy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import healpix as hp\nimport matplotlib.pylab as plt","key":"jtIZUumk0d"},{"type":"output","id":"HGkpK4zJRlXQe7Vj_X_6O","data":[],"key":"i02XxX5KXx"}],"key":"YKwo8bw07I"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HEALPix helper functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uv60KT5d2c"}],"identifier":"healpix-helper-functions","label":"HEALPix helper functions","html_id":"healpix-helper-functions","implicit":true,"key":"VjTX77fyUQ"}],"key":"HTbCDuIyVJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_nest(ds):\n    return ds.crs.healpix_order == \"nest\"\n    \ndef get_nside(ds):\n    return ds.crs.healpix_nside","key":"rE9kLQpsje"},{"type":"output","id":"pLe83Zl-wgcpDxxAPx10L","data":[],"key":"DaEkRQWIc9"}],"key":"BqfW2yHKuF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HEALPix pixel containing Boulder‚Äôs coords","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AQIkJUJcqJ"}],"identifier":"healpix-pixel-containing-boulders-coords","label":"HEALPix pixel containing Boulder‚Äôs coords","html_id":"healpix-pixel-containing-boulders-coords","implicit":true,"key":"PW5pteGcPA"}],"key":"JgkHDeSW7U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nboulder_lon = -105.2747\nboulder_lat = 40.0190\n\nboulder_pixel = hp.ang2pix(\n    get_nside(ds_fine), boulder_lon, boulder_lat, lonlat=True, nest=get_nest(ds_fine)\n)","key":"NDnd4DctWk"},{"type":"output","id":"Nkt_Qu_rAFKLKZdj4_XgW","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 292 Œºs, sys: 0 ns, total: 292 Œºs\nWall time: 296 Œºs\n"}],"key":"UeUuvcJX1E"}],"key":"AHAKxywL1W"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Global and Boulder‚Äôs temperature averages","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TxgFQVO3YX"}],"identifier":"global-and-boulders-temperature-averages","label":"Global and Boulder‚Äôs temperature averages","html_id":"global-and-boulders-temperature-averages","implicit":true,"key":"bHoNG2ENrs"}],"key":"dWLxL5ir7S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\ntime_slice = slice(\"2020-01-02T00:00:00.000000000\", \"2023-01-01T00:00:00.000000000\")\n\nds_fine.tas.sel(time=time_slice).isel(cell=boulder_pixel).plot(label=\"Boulder\")\n\nds_coarsest.tas.sel(time=time_slice).mean(\"cell\").plot(label=\"Global mean\")\n\nplt.legend()","key":"okJ7NrW91Q"},{"type":"output","id":"-izkKRuV0jB13wwCcegsT","data":[{"output_type":"stream","name":"stdout","text":"CPU times: user 161 ms, sys: 88.7 ms, total: 250 ms\nWall time: 1.97 s\n"},{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mClientResponseError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[8]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[43mget_ipython\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mrun_cell_magic\u001b[49m\u001b[43m(\u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mtime\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mtime_slice = slice(\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m2020-01-02T00:00:00.000000000\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m, \u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m2023-01-01T00:00:00.000000000\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m)\u001b[39;49m\u001b[38;5;130;43;01m\\n\u001b[39;49;00m\u001b[38;5;130;43;01m\\n\u001b[39;49;00m\u001b[33;43mds_fine.tas.sel(time=time_slice).isel(cell=boulder_pixel).plot(label=\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mBoulder\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m)\u001b[39;49m\u001b[38;5;130;43;01m\\n\u001b[39;49;00m\u001b[38;5;130;43;01m\\n\u001b[39;49;00m\u001b[33;43mds_coarsest.tas.sel(time=time_slice).mean(\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mcell\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m).plot(label=\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mGlobal mean\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43m)\u001b[39;49m\u001b[38;5;130;43;01m\\n\u001b[39;49;00m\u001b[38;5;130;43;01m\\n\u001b[39;49;00m\u001b[33;43mplt.legend()\u001b[39;49m\u001b[38;5;130;43;01m\\n\u001b[39;49;00m\u001b[33;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/IPython/core/interactiveshell.py:2565\u001b[39m, in \u001b[36mInteractiveShell.run_cell_magic\u001b[39m\u001b[34m(self, magic_name, line, cell)\u001b[39m\n\u001b[32m   2563\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m.builtin_trap:\n\u001b[32m   2564\u001b[39m     args = (magic_arg_s, cell)\n\u001b[32m-> \u001b[39m\u001b[32m2565\u001b[39m     result = \u001b[43mfn\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   2567\u001b[39m \u001b[38;5;66;03m# The code below prevents the output from being displayed\u001b[39;00m\n\u001b[32m   2568\u001b[39m \u001b[38;5;66;03m# when using magics with decorator @output_can_be_silenced\u001b[39;00m\n\u001b[32m   2569\u001b[39m \u001b[38;5;66;03m# when the last Python token in the expression is a ';'.\u001b[39;00m\n\u001b[32m   2570\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mgetattr\u001b[39m(fn, magic.MAGIC_OUTPUT_CAN_BE_SILENCED, \u001b[38;5;28;01mFalse\u001b[39;00m):\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/IPython/core/magics/execution.py:1452\u001b[39m, in \u001b[36mExecutionMagics.time\u001b[39m\u001b[34m(self, line, cell, local_ns)\u001b[39m\n\u001b[32m   1450\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m interrupt_occured:\n\u001b[32m   1451\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m exit_on_interrupt \u001b[38;5;129;01mand\u001b[39;00m captured_exception:\n\u001b[32m-> \u001b[39m\u001b[32m1452\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m captured_exception\n\u001b[32m   1453\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m\n\u001b[32m   1454\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m out\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/IPython/core/magics/execution.py:1416\u001b[39m, in \u001b[36mExecutionMagics.time\u001b[39m\u001b[34m(self, line, cell, local_ns)\u001b[39m\n\u001b[32m   1414\u001b[39m st = clock2()\n\u001b[32m   1415\u001b[39m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m-> \u001b[39m\u001b[32m1416\u001b[39m     \u001b[43mexec\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcode\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mglob\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mlocal_ns\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1417\u001b[39m     out = \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[32m   1418\u001b[39m     \u001b[38;5;66;03m# multi-line %%time case\u001b[39;00m\n\n\u001b[36mFile \u001b[39m\u001b[32m<timed exec>:3\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/plot/accessor.py:48\u001b[39m, in \u001b[36mDataArrayPlotAccessor.__call__\u001b[39m\u001b[34m(self, **kwargs)\u001b[39m\n\u001b[32m     46\u001b[39m \u001b[38;5;129m@functools\u001b[39m.wraps(dataarray_plot.plot, assigned=(\u001b[33m\"\u001b[39m\u001b[33m__doc__\u001b[39m\u001b[33m\"\u001b[39m, \u001b[33m\"\u001b[39m\u001b[33m__annotations__\u001b[39m\u001b[33m\"\u001b[39m))\n\u001b[32m     47\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m__call__\u001b[39m(\u001b[38;5;28mself\u001b[39m, **kwargs) -> Any:\n\u001b[32m---> \u001b[39m\u001b[32m48\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdataarray_plot\u001b[49m\u001b[43m.\u001b[49m\u001b[43mplot\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_da\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/plot/dataarray_plot.py:277\u001b[39m, in \u001b[36mplot\u001b[39m\u001b[34m(darray, row, col, col_wrap, ax, hue, subplot_kws, **kwargs)\u001b[39m\n\u001b[32m    226\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mplot\u001b[39m(\n\u001b[32m    227\u001b[39m     darray: DataArray,\n\u001b[32m    228\u001b[39m     *,\n\u001b[32m   (...)\u001b[39m\u001b[32m    235\u001b[39m     **kwargs: Any,\n\u001b[32m    236\u001b[39m ) -> Any:\n\u001b[32m    237\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    238\u001b[39m \u001b[33;03m    Default plot of DataArray using :py:mod:`matplotlib:matplotlib.pyplot`.\u001b[39;00m\n\u001b[32m    239\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m    273\u001b[39m \u001b[33;03m    xarray.DataArray.squeeze\u001b[39;00m\n\u001b[32m    274\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m    275\u001b[39m     darray = \u001b[43mdarray\u001b[49m\u001b[43m.\u001b[49m\u001b[43msqueeze\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    276\u001b[39m \u001b[43m        \u001b[49m\u001b[43md\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43md\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43ms\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mdarray\u001b[49m\u001b[43m.\u001b[49m\u001b[43msizes\u001b[49m\u001b[43m.\u001b[49m\u001b[43mitems\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mif\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43ms\u001b[49m\u001b[43m \u001b[49m\u001b[43m==\u001b[49m\u001b[43m \u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01mand\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43md\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01mnot\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43m(\u001b[49m\u001b[43mrow\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mcol\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mhue\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m--> \u001b[39m\u001b[32m277\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcompute\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    279\u001b[39m     plot_dims = \u001b[38;5;28mset\u001b[39m(darray.dims)\n\u001b[32m    280\u001b[39m     plot_dims.discard(row)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/core/dataarray.py:1241\u001b[39m, in \u001b[36mDataArray.compute\u001b[39m\u001b[34m(self, **kwargs)\u001b[39m\n\u001b[32m   1211\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33;03m\"\"\"Trigger loading data into memory and return a new dataarray.\u001b[39;00m\n\u001b[32m   1212\u001b[39m \n\u001b[32m   1213\u001b[39m \u001b[33;03mData will be computed and/or loaded from disk or a remote source.\u001b[39;00m\n\u001b[32m   (...)\u001b[39m\u001b[32m   1238\u001b[39m \u001b[33;03mVariable.compute\u001b[39;00m\n\u001b[32m   1239\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m   1240\u001b[39m new = \u001b[38;5;28mself\u001b[39m.copy(deep=\u001b[38;5;28;01mFalse\u001b[39;00m)\n\u001b[32m-> \u001b[39m\u001b[32m1241\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mnew\u001b[49m\u001b[43m.\u001b[49m\u001b[43mload\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/core/dataarray.py:1167\u001b[39m, in \u001b[36mDataArray.load\u001b[39m\u001b[34m(self, **kwargs)\u001b[39m\n\u001b[32m   1137\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mload\u001b[39m(\u001b[38;5;28mself\u001b[39m, **kwargs) -> Self:\n\u001b[32m   1138\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"Trigger loading data into memory and return this dataarray.\u001b[39;00m\n\u001b[32m   1139\u001b[39m \n\u001b[32m   1140\u001b[39m \u001b[33;03m    Data will be computed and/or loaded from disk or a remote source.\u001b[39;00m\n\u001b[32m   (...)\u001b[39m\u001b[32m   1165\u001b[39m \u001b[33;03m    Variable.load\u001b[39;00m\n\u001b[32m   1166\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m1167\u001b[39m     ds = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_to_temp_dataset\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m.\u001b[49m\u001b[43mload\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1168\u001b[39m     new = \u001b[38;5;28mself\u001b[39m._from_temp_dataset(ds)\n\u001b[32m   1169\u001b[39m     \u001b[38;5;28mself\u001b[39m._variable = new._variable\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/core/dataset.py:565\u001b[39m, in \u001b[36mDataset.load\u001b[39m\u001b[34m(self, **kwargs)\u001b[39m\n\u001b[32m    562\u001b[39m         \u001b[38;5;28mself\u001b[39m.variables[k].data = data\n\u001b[32m    564\u001b[39m \u001b[38;5;66;03m# load everything else sequentially\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m565\u001b[39m [\u001b[43mv\u001b[49m\u001b[43m.\u001b[49m\u001b[43mload\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mfor\u001b[39;00m k, v \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mself\u001b[39m.variables.items() \u001b[38;5;28;01mif\u001b[39;00m k \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m chunked_data]\n\u001b[32m    567\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/core/variable.py:1011\u001b[39m, in \u001b[36mVariable.load\u001b[39m\u001b[34m(self, **kwargs)\u001b[39m\n\u001b[32m    982\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mload\u001b[39m(\u001b[38;5;28mself\u001b[39m, **kwargs) -> Self:\n\u001b[32m    983\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"Trigger loading data into memory and return this variable.\u001b[39;00m\n\u001b[32m    984\u001b[39m \n\u001b[32m    985\u001b[39m \u001b[33;03m    Data will be computed and/or loaded from disk or a remote source.\u001b[39;00m\n\u001b[32m   (...)\u001b[39m\u001b[32m   1009\u001b[39m \u001b[33;03m    Dataset.load\u001b[39;00m\n\u001b[32m   1010\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m1011\u001b[39m     \u001b[38;5;28mself\u001b[39m._data = \u001b[43mto_duck_array\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_data\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1012\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/namedarray/pycompat.py:143\u001b[39m, in \u001b[36mto_duck_array\u001b[39m\u001b[34m(data, **kwargs)\u001b[39m\n\u001b[32m    140\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m loaded_data\n\u001b[32m    142\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(data, ExplicitlyIndexed | ImplicitToExplicitIndexingAdapter):\n\u001b[32m--> \u001b[39m\u001b[32m143\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mdata\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget_duck_array\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m  \u001b[38;5;66;03m# type: ignore[no-untyped-call, no-any-return]\u001b[39;00m\n\u001b[32m    144\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m is_duck_array(data):\n\u001b[32m    145\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m data\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/core/indexing.py:943\u001b[39m, in \u001b[36mMemoryCachedArray.get_duck_array\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    942\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mget_duck_array\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[32m--> \u001b[39m\u001b[32m943\u001b[39m     duck_array = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43marray\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget_duck_array\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    944\u001b[39m     \u001b[38;5;66;03m# ensure the array object is cached in-memory\u001b[39;00m\n\u001b[32m    945\u001b[39m     \u001b[38;5;28mself\u001b[39m.array = as_indexable(duck_array)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/core/indexing.py:897\u001b[39m, in \u001b[36mCopyOnWriteArray.get_duck_array\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    896\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mget_duck_array\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[32m--> \u001b[39m\u001b[32m897\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43marray\u001b[49m\u001b[43m.\u001b[49m\u001b[43mget_duck_array\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/core/indexing.py:737\u001b[39m, in \u001b[36mLazilyIndexedArray.get_duck_array\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    734\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mxarray\u001b[39;00m\u001b[34;01m.\u001b[39;00m\u001b[34;01mbackends\u001b[39;00m\u001b[34;01m.\u001b[39;00m\u001b[34;01mcommon\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m BackendArray\n\u001b[32m    736\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(\u001b[38;5;28mself\u001b[39m.array, BackendArray):\n\u001b[32m--> \u001b[39m\u001b[32m737\u001b[39m     array = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43marray\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mkey\u001b[49m\u001b[43m]\u001b[49m\n\u001b[32m    738\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    739\u001b[39m     array = apply_indexer(\u001b[38;5;28mself\u001b[39m.array, \u001b[38;5;28mself\u001b[39m.key)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/backends/zarr.py:262\u001b[39m, in \u001b[36mZarrArrayWrapper.__getitem__\u001b[39m\u001b[34m(self, key)\u001b[39m\n\u001b[32m    260\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(key, indexing.OuterIndexer):\n\u001b[32m    261\u001b[39m     method = \u001b[38;5;28mself\u001b[39m._oindex\n\u001b[32m--> \u001b[39m\u001b[32m262\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mindexing\u001b[49m\u001b[43m.\u001b[49m\u001b[43mexplicit_indexing_adapter\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    263\u001b[39m \u001b[43m    \u001b[49m\u001b[43mkey\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43marray\u001b[49m\u001b[43m.\u001b[49m\u001b[43mshape\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mindexing\u001b[49m\u001b[43m.\u001b[49m\u001b[43mIndexingSupport\u001b[49m\u001b[43m.\u001b[49m\u001b[43mVECTORIZED\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmethod\u001b[49m\n\u001b[32m    264\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/core/indexing.py:1129\u001b[39m, in \u001b[36mexplicit_indexing_adapter\u001b[39m\u001b[34m(key, shape, indexing_support, raw_indexing_method)\u001b[39m\n\u001b[32m   1107\u001b[39m \u001b[38;5;250m\u001b[39m\u001b[33;03m\"\"\"Support explicit indexing by delegating to a raw indexing method.\u001b[39;00m\n\u001b[32m   1108\u001b[39m \n\u001b[32m   1109\u001b[39m \u001b[33;03mOuter and/or vectorized indexers are supported by indexing a second time\u001b[39;00m\n\u001b[32m   (...)\u001b[39m\u001b[32m   1126\u001b[39m \u001b[33;03mIndexing result, in the form of a duck numpy-array.\u001b[39;00m\n\u001b[32m   1127\u001b[39m \u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m   1128\u001b[39m raw_key, numpy_indices = decompose_indexer(key, shape, indexing_support)\n\u001b[32m-> \u001b[39m\u001b[32m1129\u001b[39m result = \u001b[43mraw_indexing_method\u001b[49m\u001b[43m(\u001b[49m\u001b[43mraw_key\u001b[49m\u001b[43m.\u001b[49m\u001b[43mtuple\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1130\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m numpy_indices.tuple:\n\u001b[32m   1131\u001b[39m     \u001b[38;5;66;03m# index the loaded duck array\u001b[39;00m\n\u001b[32m   1132\u001b[39m     indexable = as_indexable(result)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/xarray/backends/zarr.py:225\u001b[39m, in \u001b[36mZarrArrayWrapper._getitem\u001b[39m\u001b[34m(self, key)\u001b[39m\n\u001b[32m    224\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m_getitem\u001b[39m(\u001b[38;5;28mself\u001b[39m, key):\n\u001b[32m--> \u001b[39m\u001b[32m225\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_array\u001b[49m\u001b[43m[\u001b[49m\u001b[43mkey\u001b[49m\u001b[43m]\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/zarr/core.py:797\u001b[39m, in \u001b[36mArray.__getitem__\u001b[39m\u001b[34m(self, selection)\u001b[39m\n\u001b[32m    795\u001b[39m     result = \u001b[38;5;28mself\u001b[39m.vindex[selection]\n\u001b[32m    796\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m is_pure_orthogonal_indexing(pure_selection, \u001b[38;5;28mself\u001b[39m.ndim):\n\u001b[32m--> \u001b[39m\u001b[32m797\u001b[39m     result = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mget_orthogonal_selection\u001b[49m\u001b[43m(\u001b[49m\u001b[43mpure_selection\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mfields\u001b[49m\u001b[43m=\u001b[49m\u001b[43mfields\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    798\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m    799\u001b[39m     result = \u001b[38;5;28mself\u001b[39m.get_basic_selection(pure_selection, fields=fields)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/zarr/core.py:1079\u001b[39m, in \u001b[36mArray.get_orthogonal_selection\u001b[39m\u001b[34m(self, selection, out, fields)\u001b[39m\n\u001b[32m   1076\u001b[39m \u001b[38;5;66;03m# setup indexer\u001b[39;00m\n\u001b[32m   1077\u001b[39m indexer = OrthogonalIndexer(selection, \u001b[38;5;28mself\u001b[39m)\n\u001b[32m-> \u001b[39m\u001b[32m1079\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_get_selection\u001b[49m\u001b[43m(\u001b[49m\u001b[43mindexer\u001b[49m\u001b[43m=\u001b[49m\u001b[43mindexer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mout\u001b[49m\u001b[43m=\u001b[49m\u001b[43mout\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mfields\u001b[49m\u001b[43m=\u001b[49m\u001b[43mfields\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/zarr/core.py:1342\u001b[39m, in \u001b[36mArray._get_selection\u001b[39m\u001b[34m(self, indexer, out, fields)\u001b[39m\n\u001b[32m   1339\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m math.prod(out_shape) > \u001b[32m0\u001b[39m:\n\u001b[32m   1340\u001b[39m     \u001b[38;5;66;03m# allow storage to get multiple items at once\u001b[39;00m\n\u001b[32m   1341\u001b[39m     lchunk_coords, lchunk_selection, lout_selection = \u001b[38;5;28mzip\u001b[39m(*indexer)\n\u001b[32m-> \u001b[39m\u001b[32m1342\u001b[39m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_chunk_getitems\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m   1343\u001b[39m \u001b[43m        \u001b[49m\u001b[43mlchunk_coords\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1344\u001b[39m \u001b[43m        \u001b[49m\u001b[43mlchunk_selection\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1345\u001b[39m \u001b[43m        \u001b[49m\u001b[43mout\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1346\u001b[39m \u001b[43m        \u001b[49m\u001b[43mlout_selection\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1347\u001b[39m \u001b[43m        \u001b[49m\u001b[43mdrop_axes\u001b[49m\u001b[43m=\u001b[49m\u001b[43mindexer\u001b[49m\u001b[43m.\u001b[49m\u001b[43mdrop_axes\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1348\u001b[39m \u001b[43m        \u001b[49m\u001b[43mfields\u001b[49m\u001b[43m=\u001b[49m\u001b[43mfields\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   1349\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   1350\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m out.shape:\n\u001b[32m   1351\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m out\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/zarr/core.py:2183\u001b[39m, in \u001b[36mArray._chunk_getitems\u001b[39m\u001b[34m(self, lchunk_coords, lchunk_selection, out, lout_selection, drop_axes, fields)\u001b[39m\n\u001b[32m   2181\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(\u001b[38;5;28mself\u001b[39m._meta_array, np.ndarray):\n\u001b[32m   2182\u001b[39m         contexts = ConstantMap(ckeys, constant=Context(meta_array=\u001b[38;5;28mself\u001b[39m._meta_array))\n\u001b[32m-> \u001b[39m\u001b[32m2183\u001b[39m     cdatas = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mchunk_store\u001b[49m\u001b[43m.\u001b[49m\u001b[43mgetitems\u001b[49m\u001b[43m(\u001b[49m\u001b[43mckeys\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mcontexts\u001b[49m\u001b[43m=\u001b[49m\u001b[43mcontexts\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m   2185\u001b[39m \u001b[38;5;28;01mfor\u001b[39;00m ckey, chunk_select, out_select \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mzip\u001b[39m(ckeys, lchunk_selection, lout_selection):\n\u001b[32m   2186\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m ckey \u001b[38;5;129;01min\u001b[39;00m cdatas:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/zarr/storage.py:1435\u001b[39m, in \u001b[36mFSStore.getitems\u001b[39m\u001b[34m(self, keys, contexts)\u001b[39m\n\u001b[32m   1432\u001b[39m     \u001b[38;5;28;01mcontinue\u001b[39;00m\n\u001b[32m   1433\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(v, \u001b[38;5;167;01mException\u001b[39;00m):\n\u001b[32m   1434\u001b[39m     \u001b[38;5;66;03m# Raise any other exception\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m1435\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m v\n\u001b[32m   1436\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m   1437\u001b[39m     \u001b[38;5;66;03m# The function calling this method may not recognize the transformed\u001b[39;00m\n\u001b[32m   1438\u001b[39m     \u001b[38;5;66;03m# keys, so we send the values returned by self.map.getitems back into\u001b[39;00m\n\u001b[32m   1439\u001b[39m     \u001b[38;5;66;03m# the original key space.\u001b[39;00m\n\u001b[32m   1440\u001b[39m     results[keys_transformed[k]] = v\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/fsspec/asyn.py:244\u001b[39m, in \u001b[36m_run_coros_in_chunks.<locals>._run_coro\u001b[39m\u001b[34m(coro, i)\u001b[39m\n\u001b[32m    242\u001b[39m \u001b[38;5;28;01masync\u001b[39;00m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34m_run_coro\u001b[39m(coro, i):\n\u001b[32m    243\u001b[39m     \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m--> \u001b[39m\u001b[32m244\u001b[39m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;01mawait\u001b[39;00m asyncio.wait_for(coro, timeout=timeout), i\n\u001b[32m    245\u001b[39m     \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[32m    246\u001b[39m         \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m return_exceptions:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/asyncio/tasks.py:507\u001b[39m, in \u001b[36mwait_for\u001b[39m\u001b[34m(fut, timeout)\u001b[39m\n\u001b[32m    504\u001b[39m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTimeoutError\u001b[39;00m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mexc\u001b[39;00m\n\u001b[32m    506\u001b[39m \u001b[38;5;28;01masync\u001b[39;00m \u001b[38;5;28;01mwith\u001b[39;00m timeouts.timeout(timeout):\n\u001b[32m--> \u001b[39m\u001b[32m507\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;01mawait\u001b[39;00m fut\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/fsspec/implementations/http.py:246\u001b[39m, in \u001b[36mHTTPFileSystem._cat_file\u001b[39m\u001b[34m(self, url, start, end, **kwargs)\u001b[39m\n\u001b[32m    244\u001b[39m \u001b[38;5;28;01masync\u001b[39;00m \u001b[38;5;28;01mwith\u001b[39;00m session.get(\u001b[38;5;28mself\u001b[39m.encode_url(url), **kw) \u001b[38;5;28;01mas\u001b[39;00m r:\n\u001b[32m    245\u001b[39m     out = \u001b[38;5;28;01mawait\u001b[39;00m r.read()\n\u001b[32m--> \u001b[39m\u001b[32m246\u001b[39m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_raise_not_found_for_status\u001b[49m\u001b[43m(\u001b[49m\u001b[43mr\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43murl\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    247\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m out\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/fsspec/implementations/http.py:229\u001b[39m, in \u001b[36mHTTPFileSystem._raise_not_found_for_status\u001b[39m\u001b[34m(self, response, url)\u001b[39m\n\u001b[32m    227\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m response.status == \u001b[32m404\u001b[39m:\n\u001b[32m    228\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mFileNotFoundError\u001b[39;00m(url)\n\u001b[32m--> \u001b[39m\u001b[32m229\u001b[39m \u001b[43mresponse\u001b[49m\u001b[43m.\u001b[49m\u001b[43mraise_for_status\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/aiohttp/client_reqrep.py:638\u001b[39m, in \u001b[36mClientResponse.raise_for_status\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    635\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m._in_context:\n\u001b[32m    636\u001b[39m     \u001b[38;5;28mself\u001b[39m.release()\n\u001b[32m--> \u001b[39m\u001b[32m638\u001b[39m \u001b[38;5;28;01mraise\u001b[39;00m ClientResponseError(\n\u001b[32m    639\u001b[39m     \u001b[38;5;28mself\u001b[39m.request_info,\n\u001b[32m    640\u001b[39m     \u001b[38;5;28mself\u001b[39m.history,\n\u001b[32m    641\u001b[39m     status=\u001b[38;5;28mself\u001b[39m.status,\n\u001b[32m    642\u001b[39m     message=\u001b[38;5;28mself\u001b[39m.reason,\n\u001b[32m    643\u001b[39m     headers=\u001b[38;5;28mself\u001b[39m.headers,\n\u001b[32m    644\u001b[39m )\n\n\u001b[31mClientResponseError\u001b[39m: 503, message='Service Unavailable', url='https://s3.eu-dkrz-1.dkrz.cloud/nextgems/rechunked_ngc4008/ngc4008_P1D_7.zarr/tas/1/0'","ename":"ClientResponseError","evalue":"503, message='Service Unavailable', url='https://s3.eu-dkrz-1.dkrz.cloud/nextgems/rechunked_ngc4008/ngc4008_P1D_7.zarr/tas/1/0'"}],"key":"qE8Kmzuwhy"}],"key":"N0kfWc8t7j"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting with easy.gems and cartopy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FqifIDzoiF"}],"identifier":"plotting-with-easy-gems-and-cartopy","label":"Plotting with easy.gems and cartopy","html_id":"plotting-with-easy-gems-and-cartopy","implicit":true,"key":"jCONzjLHBP"}],"key":"IRTRPgKW5R"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this part, we will look at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G24v1SwhLx"},{"type":"inlineCode","value":" healpix_show","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AJ1UVOcAJM"},{"type":"text","value":" function that is provided by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UyesVf0t7G"},{"type":"inlineCode","value":"easy.gems","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aa8O8rAekV"},{"type":"text","value":" for convenient HEALPix plotting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WgrkI8XkWr"}],"key":"QD3KfbSqdA"}],"key":"qEMePTDvzc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import easygems.healpix as eghp\n\nimport cartopy.crs as ccrs\nimport cartopy.feature as cf\nimport cmocean","key":"nSRW9D9sgo"},{"type":"output","id":"riLtBtqq9l8MGNWgXdZIg","data":[],"key":"YK25wbfj9f"}],"key":"dxec3n1Kgt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Global plots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UeccLmORtS"}],"identifier":"global-plots","label":"Global plots","html_id":"global-plots","implicit":true,"key":"wLbpb39mef"}],"key":"KW4VHp52dW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Most of this is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8tTywSUah"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dyUc09RiwD"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ymCIjXCZHD"},{"type":"inlineCode","value":"cartopy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qcoUclLEG7"},{"type":"text","value":" code, but have a look at how ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u89ccyZD9S"},{"type":"inlineCode","value":"eghp.healpix_show()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uoTxrzkYhB"},{"type":"text","value":" is called. The following code will plot global temperature (at the first timestep for simplicity)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YRnKd202oV"}],"key":"um0JZ8zxYB"}],"key":"cJVOPZCQZT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"projection = ccrs.Robinson(central_longitude=-135.5808361)\n\nfig, ax = plt.subplots(\n    figsize=(8, 4), subplot_kw={\"projection\": projection}, constrained_layout=True\n)\n\nax.set_global()\n\neghp.healpix_show(ds_fine.tas.isel(time=0), ax=ax, cmap=cmocean.cm.thermal)\n\nax.add_feature(cf.COASTLINE, linewidth=0.8)\nax.add_feature(cf.BORDERS, linewidth=0.4)","key":"eOeIzR5ok9"},{"type":"output","id":"62uDCcKAXFjcwAc0WKwWw","data":[],"key":"oZAGpr8xq9"}],"key":"LyAlZvUCrI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Regional plots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MDKsFWOOLo"}],"identifier":"regional-plots","label":"Regional plots","html_id":"regional-plots","implicit":true,"key":"jvMPl7ZqWt"}],"key":"bBVosprHrB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If plotting a region of interest is desired, it is also possible through setting extents of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hv87xD08uS"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NQef6sS4IC"},{"type":"text","value":" plot.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T1Ru07T811"}],"key":"IACOkP4AYm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let us look into USA map using the Boulder, CO, USA coords we had used before for simplicity:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yh59yU7G90"}],"key":"VDDgZ0Tx8x"}],"key":"skEEajxXQV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"projection = ccrs.Robinson(central_longitude=boulder_lon)\n\nfig, ax = plt.subplots(\n    figsize=(8, 4), subplot_kw={\"projection\": projection}, constrained_layout=True\n)\nax.set_extent([boulder_lon-20, boulder_lon+40, boulder_lat-20, boulder_lat+10], crs=ccrs.PlateCarree())\n\neghp.healpix_show(ds_fine.tas.isel(time=0), ax=ax, cmap=cmocean.cm.thermal)\n\nax.add_feature(cf.COASTLINE, linewidth=0.8)\nax.add_feature(cf.BORDERS, linewidth=0.4)","key":"Gijfj3hqwC"},{"type":"output","id":"enGetFlyZykhLwMnxGaiq","data":[],"key":"sL1DB3t2KO"}],"key":"mLG9w5ONL3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Further ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Qb5IqMaouY"},{"type":"inlineCode","value":"easy.gems","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LFZJvDyNrp"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vonib5Y3Yg"},{"type":"inlineCode","value":"healpix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WrK9L6mmUn"}],"identifier":"further-easy-gems-and-healpix","label":"Further easy.gems and healpix","html_id":"further-easy-gems-and-healpix","implicit":true,"key":"KAqJDCVdU0"}],"key":"lnFVBfZ7rj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"These are only a sampling of HEALPix and easy.gems capabilities; if you are interested in learning more, be sure to check out the usage examples at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kyPvfUJU8u"},{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/index.html#","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"easy.gems HEALPix Documentation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bvHWvy4l0j"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/index.html#","key":"JV1vvVirP4"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TbToFZGrHv"}],"key":"ZYXaVukhCD"}],"key":"BMg3Z10kB7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What is next?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cD93Frdsoz"}],"identifier":"what-is-next","label":"What is next?","html_id":"what-is-next","implicit":true,"key":"tKwCqkw03n"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JklIaHhn82"},{"type":"link","url":"/notebooks/uxarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"next section","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L6sr94py2H"}],"urlSource":"02-uxarray","dataUrl":"/notebooks.uxarray.json","internal":true,"protocol":"file","key":"i25xGGfm8I"},{"type":"text","value":" will provide an UXarray workflow that loads in and analyzes & visualizes HEALPix data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"noEnZ5zta5"}],"key":"vR8ZvmCiS1"}],"key":"Uz1XhMWsD9"}],"key":"MQQ4wWTkEn"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"HEALPix Overview","url":"/notebooks/healpix","group":"Introduction to HEALPix"},"next":{"title":"UXarray for Basic HEALPix Statistics & Visualization","url":"/notebooks/uxarray","group":"HEALPix Analysis & Visualization"}}},"domain":"http://localhost:3000"}