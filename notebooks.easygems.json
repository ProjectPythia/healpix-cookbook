{"version":3,"kind":"Notebook","sha256":"d9b430115d95e25fa15dd9ade7082b07f425f92d411ad5c3a614b1612d741f58","slug":"notebooks.easygems","location":"/notebooks/01-easygems.ipynb","dependencies":[],"frontmatter":{"title":"easy.gems for HEALPix Analysis & Visualization","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/healpix-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/projectpythia/healpix-cookbook/blob/main/notebooks/01-easygems.ipynb","edit_url":"https://github.com/projectpythia/healpix-cookbook/edit/main/notebooks/01-easygems.ipynb","thumbnail":"/healpix-cookbook/build/017413bc2a0a2abc303b8562edfce112.png","exports":[{"format":"ipynb","filename":"01-easygems.ipynb","url":"/healpix-cookbook/build/01-easygems-ae4b81dd9319a6fa888834cca7f4e81e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/healpix-cookbook/build/017413bc2a0a2abc303b8562edfce112.png","alt":"HEALPix logo","width":"30%","key":"LojfYo4S9Y","urlSource":"https://easy.gems.dkrz.de/_images/landing-page-banner.png"}],"key":"ObpNDukd55"},{"type":"heading","depth":1,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"easy.gems for HEALPix Analysis & Visualization","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VLLr0wHDC7"}],"identifier":"easy-gems-for-healpix-analysis-visualization","label":"easy.gems for HEALPix Analysis & Visualization","html_id":"easy-gems-for-healpix-analysis-visualization","implicit":true,"key":"GLZ8nanOVm"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In this section, you‚Äôll learn:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MTLsv6EPTG"}],"identifier":"in-this-section-youll-learn","label":"In this section, you‚Äôll learn:","html_id":"in-this-section-youll-learn","implicit":true,"key":"ONFfyFhh9K"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Utilizing intake to open a HEALPix data catalog","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"TG2wb7I93b"}],"key":"NFsJlmfIJ7"}],"key":"IFsRHm9shi"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"BcGkh2h8Va"},{"type":"inlineCode","value":"healpix","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Cb8AH2E54H"},{"type":"text","value":" package to perform HEALPix operations to look at basic statistics","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"YWbwJROU5C"}],"key":"PP1Dsv7ori"}],"key":"CqvBw0s2iw"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plotting HEALPix data via easy.gems functionality","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"r95aSiaGKu"}],"key":"EcNYYs5daI"}],"key":"TaQ9I5rdMf"}],"key":"pCBt7fQHLv"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Related Documentation","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"eo4aiKh7HT"}],"identifier":"related-documentation","label":"Related Documentation","html_id":"related-documentation","implicit":true,"key":"VsCuxzWdln"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starter.html#","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Getting started with hierarchical HEALPix data - easy.gems Documentation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Gf2HjpmBj7"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starter.html#","key":"uCbyRZdh29"}],"key":"pngPX2KPeZ"}],"key":"EGO2ZVroq9"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/healpix_cartopy.html","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Plotting with cartopy - easy.gems Documentation","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"GIb7wSxMEU"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/healpix_cartopy.html","key":"UrPpFdSK2P"}],"key":"wodCW6rH2y"}],"key":"XhqZ5VPPjH"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://projectpythia.org/intake-cookbook","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Intake Cookbook","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KVW41WhIzi"}],"urlSource":"https://projectpythia.org/intake-cookbook","key":"q78NBayphO"}],"key":"ELmsqthbtt"}],"key":"mqBIHquzQ4"}],"key":"kuba8nXdi2"},{"type":"heading","depth":3,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ChaSyOQZ62"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"Yf4VjO2uNO"},{"type":"table","position":{"start":{"line":23,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"m48jE6SMvA"}],"key":"JZCXaYK5BD"},{"type":"tableCell","header":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"BCB3RGWgXj"}],"key":"FMANc5bMQO"},{"type":"tableCell","header":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"N5jl4KmaBX"}],"key":"NHY968aVht"}],"key":"K2FrFZtmub"},{"type":"tableRow","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"link","url":"/notebooks/healpix","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"HEALPix overview","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"UvaJLytA1P"}],"urlSource":"00-healpix","dataUrl":"/notebooks.healpix.json","internal":true,"protocol":"file","key":"AdkvGyeGRP"}],"key":"Kd1mR8Cdhw"},{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"d86696pC15"}],"key":"vTSgmtkxgZ"},{"type":"tableCell","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[],"key":"x8pTHW9L7J"}],"key":"OI8TCLVvIF"}],"key":"dlfDOnONNG"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"VJEr1bjEl0"}],"key":"ms2YI0Geih"},{"type":"text","value":": 30 minutes","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"oXPjJPL1k9"}],"key":"mtaYsQm1T8"},{"type":"thematicBreak","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"r6CKIQ431t"}],"key":"iKVoPAV4Rg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Open data catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pX16gHlZxe"}],"identifier":"open-data-catalog","label":"Open data catalog","html_id":"open-data-catalog","implicit":true,"key":"tOCPedxAVN"}],"key":"eRL56cSOO2"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"QHOaGz1qTs"}],"key":"KJ0HPIrQXi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If you think that you first need to learn about Intake, Pythia‚Äôs ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mAfRF4089S"},{"type":"link","url":"https://projectpythia.org/intake-cookbook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Intake Cookbook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xajFgwDfnL"}],"urlSource":"https://projectpythia.org/intake-cookbook","key":"RVrfZhniYE"},{"type":"text","value":" is a great resource to do so.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QBrTGmUTQH"}],"key":"LeFnZ3ae6E"}],"key":"SYhE6XiSra"}],"key":"FsOBnEOahd"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us use the online data catalog from the WCRP‚Äôs Digital Earths Global Hackathon 2025‚Äôs ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JXckiKBZZs"},{"type":"link","url":"https://github.com/digital-earths-global-hackathon/catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"catalog repository","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D8nbD8Z3pg"}],"urlSource":"https://github.com/digital-earths-global-hackathon/catalog","error":true,"key":"HZGUCmAL3U"},{"type":"text","value":" using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wuSVO5HD04"},{"type":"inlineCode","value":"intake","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FvlSpKorqd"},{"type":"text","value":" and read the output of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GKWLUO1gqx"},{"type":"inlineCode","value":"ICON","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s4RinbujGF"},{"type":"text","value":" simulation run ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nWwWgJcpnw"},{"type":"inlineCode","value":"ngc4008","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lWMSH3cJqH"},{"type":"text","value":", which is stored in the HEALPix format:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"avGKY7RMxR"}],"key":"QyOfxodEBY"}],"key":"iKS1PzzB1e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import intake\n\n# Hackathon data catalogs\ncat_url = \"https://digital-earths-global-hackathon.github.io/catalog/catalog.yaml\"\ncat = intake.open_catalog(cat_url).online\nmodel_run = cat.icon_ngc4008","key":"mUUzgKmZh1"},{"type":"outputs","id":"KF1zDjPWp7RZdqCJmjkBd","children":[],"key":"rHU0DlnX9q"}],"key":"iBwojrZuAG"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"sCkB0HWNb2"}],"key":"DOYRi6axy7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We highly recommend checking out the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J86PT9AKYY"},{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starter.html#the-catalog","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"easy.gems documentation on HEALPix data catalogs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"B8xKMXcVH2"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starter.html#the-catalog","key":"JmSjwPD0Bf"},{"type":"text","value":" to understand the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e8kVnnkUNR"},{"type":"inlineCode","value":"zoom","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sHGgXpiXqa"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VRRow2aHun"},{"type":"inlineCode","value":"time","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O5JBqEC1Hy"},{"type":"text","value":" parametrization of the model runs in the catalogs. In short, each model run has an independent ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oZ7sRo20xZ"},{"type":"inlineCode","value":"Dataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"byHScxIdex"},{"type":"text","value":" for each combination of the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p9lFwmNjs7"},{"type":"inlineCode","value":"zoom","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fXxHUw3so1"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O3dvfXmV4F"},{"type":"inlineCode","value":"time","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gnNZoshzA9"},{"type":"text","value":" parameters as depicted below (image credit ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iN3SHSJoQO"},{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starterhtml#the-catalog","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"easy.gems documentation on HEALPix data catalogs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rxjjkshoX4"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/healpix_starterhtml#the-catalog","key":"roZJKvV16M"},{"type":"text","value":", and ‚ÄúPT30M‚Äù in this figure should be ‚ÄúPT15M‚Äù, 15 minutes, for the hackathon data we are using here)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zwbK60OgFx"}],"key":"OmReCIcUfL"}],"key":"h5duhhAwCn"}],"key":"iGhusof9Fy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"image","url":"/healpix-cookbook/build/044ab28ae681f5d84334a3e152648819.png","alt":"Matplotlib Logo","width":600,"key":"ponDpWmfm5","urlSource":"https://easy.gems.dkrz.de/_images/ds_hierarchy.png"}],"key":"P5jmfhOSyC"}],"key":"oQqpTbQcv7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Explore datasets","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BlqHliY6iV"}],"identifier":"explore-datasets","label":"Explore datasets","html_id":"explore-datasets","implicit":true,"key":"pBzOM8S42x"}],"key":"d4CWdFvAoV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So, the coarsest dataset in this model run would be as follows (Even if we called it without specifying any parameters, i.e. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SKGQBPcGa9"},{"type":"inlineCode","value":"model_run.to_dask()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xqbluhxs0o"},{"type":"text","value":", the result would be same as the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iFnho5SKZp"},{"type":"inlineCode","value":"ds_coarsest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GKkyqPd006"},{"type":"text","value":" below since this model run defaults to the coarsest settings):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qUoHg0O1f0"}],"key":"cDzOVdf8HE"}],"key":"wsgDMVGyUG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_coarsest = model_run(zoom=0, time=\"P1D\").to_dask()\nds_coarsest","key":"oDJmiMsxTA"},{"type":"outputs","id":"C9JzhhbDdSvzcHl8F9SrU","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/intake_xarray/base.py:21: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  'dims': dict(self._ds.dims),\n"},"key":"dJJHFmVaia"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 883MB\nDimensions:                              (time: 10958, depth_half: 73,\n                                          cell: 12, level_full: 90,\n                                          soil_depth_water_level: 5,\n                                          depth_full: 72, level_half: 91,\n                                          soil_depth_energy_level: 5, crs: 1)\nCoordinates:\n  * time                                 (time) datetime64[ns] 88kB 2020-01-0...\n  * depth_half                           (depth_half) float32 292B 0.0 ... 5....\n  * level_full                           (level_full) int32 360B 1 2 3 ... 89 90\n  * soil_depth_water_level               (soil_depth_water_level) float32 20B ...\n  * depth_full                           (depth_full) float32 288B 1.0 ... 5....\n  * level_half                           (level_half) int32 364B 1 2 3 ... 90 91\n  * soil_depth_energy_level              (soil_depth_energy_level) float32 20B ...\n  * crs                                  (crs) float32 4B nan\nDimensions without coordinates: cell\nData variables: (12/103)\n    A_tracer_v_to                        (time, depth_half, cell) float32 38MB ...\n    FrshFlux_IceSalt                     (time, cell) float32 526kB ...\n    FrshFlux_TotalIce                    (time, cell) float32 526kB ...\n    Qbot                                 (time, cell) float32 526kB ...\n    Qtop                                 (time, cell) float32 526kB ...\n    Wind_Speed_10m                       (time, cell) float32 526kB ...\n    ...                                   ...\n    vas                                  (time, cell) float32 526kB ...\n    w                                    (time, depth_half, cell) float32 38MB ...\n    wa_phy                               (time, level_half, cell) float32 48MB ...\n    zg                                   (level_full, cell) float32 4kB ...\n    zghalf                               (level_half, cell) float32 4kB ...\n    zos                                  (time, cell) float32 526kB ...","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"109e0559c60a4980417fdf1f07488040","path":"/healpix-cookbook/build/109e0559c60a4980417fdf1f07488040.html"}}},"key":"FoFK7JLCbr"}],"key":"FgN9gbS1R6"}],"key":"KqAiCTVg3j"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, let us look at a dataset with finer zoom level still with the coarsest time and another dataset with a finer zoom level and the finest time (which may be useful for daily analyses) dataset:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BG1UHMKaXc"}],"key":"CklK7CbPb3"}],"key":"TuNgFlkEeF"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_fine = model_run(zoom=7).to_dask()\nds_fine","key":"xKva5ida4G"},{"type":"outputs","id":"BHomVG4Igr1a-TyTyNoBD","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/intake_xarray/base.py:21: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  'dims': dict(self._ds.dims),\n"},"key":"hYBLESQXem"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 14TB\nDimensions:                              (time: 10958, depth_half: 73,\n                                          cell: 196608, level_full: 90,\n                                          soil_depth_water_level: 5,\n                                          depth_full: 72, level_half: 91,\n                                          soil_depth_energy_level: 5, crs: 1)\nCoordinates:\n  * time                                 (time) datetime64[ns] 88kB 2020-01-0...\n  * depth_half                           (depth_half) float32 292B 0.0 ... 5....\n  * level_full                           (level_full) int32 360B 1 2 3 ... 89 90\n  * soil_depth_water_level               (soil_depth_water_level) float32 20B ...\n  * depth_full                           (depth_full) float32 288B 1.0 ... 5....\n  * level_half                           (level_half) int32 364B 1 2 3 ... 90 91\n  * soil_depth_energy_level              (soil_depth_energy_level) float32 20B ...\n  * crs                                  (crs) float32 4B nan\nDimensions without coordinates: cell\nData variables: (12/103)\n    A_tracer_v_to                        (time, depth_half, cell) float32 629GB ...\n    FrshFlux_IceSalt                     (time, cell) float32 9GB ...\n    FrshFlux_TotalIce                    (time, cell) float32 9GB ...\n    Qbot                                 (time, cell) float32 9GB ...\n    Qtop                                 (time, cell) float32 9GB ...\n    Wind_Speed_10m                       (time, cell) float32 9GB ...\n    ...                                   ...\n    vas                                  (time, cell) float32 9GB ...\n    w                                    (time, depth_half, cell) float32 629GB ...\n    wa_phy                               (time, level_half, cell) float32 784GB ...\n    zg                                   (level_full, cell) float32 71MB ...\n    zghalf                               (level_half, cell) float32 72MB ...\n    zos                                  (time, cell) float32 9GB ...","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"71dd550492c949a63688872bb0441013","path":"/healpix-cookbook/build/71dd550492c949a63688872bb0441013.html"}}},"key":"HFgtXHPKLT"}],"key":"UZ2lrn8G2g"}],"key":"NGIbTRDw73"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_finesttime = model_run(zoom=6, time=\"PT15M\").to_dask()\nds_finesttime","key":"qLKVZ1Dmgy"},{"type":"outputs","id":"Awc06kIK8ftlTvpYmnnMQ","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/intake_xarray/base.py:21: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.\n  'dims': dict(self._ds.dims),\n"},"key":"pRr3lPPnyp"},{"type":"output","children":[],"jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 1TB\nDimensions:  (time: 1051968, cell: 49152, crs: 1)\nCoordinates:\n  * time     (time) datetime64[ns] 8MB 2020-01-01T00:15:00 ... 2050-01-01\n  * crs      (crs) float32 4B nan\nDimensions without coordinates: cell\nData variables:\n    pr       (time, cell) float32 207GB ...\n    qv2m     (time, cell) float32 207GB ...\n    rlut     (time, cell) float32 207GB ...\n    rsds     (time, cell) float32 207GB ...\n    sfcwind  (time, cell) float32 207GB ...\n    tas      (time, cell) float32 207GB ...","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in notebooks */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n  line-height: 1.6;\n  padding-bottom: 4px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n}\n\n.xr-header {\n  border-bottom: solid 1px var(--xr-border-color);\n  margin-bottom: 4px;\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-obj-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type,\n.xr-group-box-contents > label {\n  color: var(--xr-font-color2);\n  display: block;\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n  margin-block-start: 0;\n  margin-block-end: 0;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item > input,\n.xr-group-box-contents > input,\n.xr-array-wrap > input {\n  display: block;\n  opacity: 0;\n  height: 0;\n  margin: 0;\n}\n\n.xr-section-item > input + label,\n.xr-var-item > input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item > input:enabled + label,\n.xr-var-item > input:enabled + label,\n.xr-array-wrap > input:enabled + label,\n.xr-group-box-contents > input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item > input:focus-visible + label,\n.xr-var-item > input:focus-visible + label,\n.xr-array-wrap > input:focus-visible + label,\n.xr-group-box-contents > input:focus-visible + label {\n  outline: auto;\n}\n\n.xr-section-item > input:enabled + label:hover,\n.xr-var-item > input:enabled + label:hover,\n.xr-array-wrap > input:enabled + label:hover,\n.xr-group-box-contents > input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n  white-space: nowrap;\n}\n\n.xr-section-summary > em {\n  font-weight: normal;\n}\n\n.xr-span-grid {\n  grid-column-end: -1;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.3em;\n}\n\n.xr-group-box-contents > input:checked + label > span {\n  display: inline-block;\n  padding-left: 0.6em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details,\n.xr-group-box-contents > label {\n  padding-top: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  grid-column: 1 / -1;\n  margin-top: 4px;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in ~ .xr-section-details {\n  display: none;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-children {\n  display: inline-grid;\n  grid-template-columns: 100%;\n  grid-column: 1 / -1;\n  padding-top: 4px;\n}\n\n.xr-group-box {\n  display: inline-grid;\n  grid-template-columns: 0px 30px auto;\n}\n\n.xr-group-box-vline {\n  grid-column-start: 1;\n  border-right: 0.2em solid;\n  border-color: var(--xr-border-color);\n  width: 0px;\n}\n\n.xr-group-box-hline {\n  grid-column-start: 2;\n  grid-row-start: 1;\n  height: 1em;\n  width: 26px;\n  border-bottom: 0.2em solid;\n  border-color: var(--xr-border-color);\n}\n\n.xr-group-box-contents {\n  grid-column-start: 3;\n  padding-bottom: 4px;\n}\n\n.xr-group-box-contents > label::before {\n  content: \"üìÇ\";\n  padding-right: 0.3em;\n}\n\n.xr-group-box-contents > input:checked + label::before {\n  content: \"üìÅ\";\n}\n\n.xr-group-box-contents > input:checked + label {\n  padding-bottom: 0px;\n}\n\n.xr-group-box-contents > input:checked ~ .xr-sections {\n  display: none;\n}\n\n.xr-group-box-contents > input + label > span {\n  display: none;\n}\n\n.xr-group-box-ellipsis {\n  font-size: 1.4em;\n  font-weight: 900;\n  color: var(--xr-font-color2);\n  letter-spacing: 0.15em;\n  cursor: default;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1TB\nDimensions:  (time: 1051968, cell: 49152, crs: 1)\nCoordinates:\n  * time     (time) datetime64[ns] 8MB 2020-01-01T00:15:00 ... 2050-01-01\n  * crs      (crs) float32 4B nan\nDimensions without coordinates: cell\nData variables:\n    pr       (time, cell) float32 207GB ...\n    qv2m     (time, cell) float32 207GB ...\n    rlut     (time, cell) float32 207GB ...\n    rsds     (time, cell) float32 207GB ...\n    sfcwind  (time, cell) float32 207GB ...\n    tas      (time, cell) float32 207GB ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-32812c25-526c-48c0-8d05-8562886c8ed1' class='xr-section-summary-in' type='checkbox' disabled /><label for='section-32812c25-526c-48c0-8d05-8562886c8ed1' class='xr-section-summary'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1051968</li><li><span>cell</span>: 49152</li><li><span class='xr-has-index'>crs</span>: 1</li></ul></div></li><li class='xr-section-item'><input id='section-5a26ec86-cfdb-456d-b213-bee3bf06e2c9' class='xr-section-summary-in' type='checkbox' checked /><label for='section-5a26ec86-cfdb-456d-b213-bee3bf06e2c9' class='xr-section-summary' title='Expand/collapse section'>Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-01-01T00:15:00 ... 2050-01-01</div><input id='attrs-42ff54cb-6d3a-438c-9873-3bff5baf9376' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-42ff54cb-6d3a-438c-9873-3bff5baf9376' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-68f14233-6f14-499b-afa0-68de4b20eb19' class='xr-var-data-in' type='checkbox'><label for='data-68f14233-6f14-499b-afa0-68de4b20eb19' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-01-01T00:15:00.000000000&#x27;, &#x27;2020-01-01T00:30:00.000000000&#x27;,\n       &#x27;2020-01-01T00:45:00.000000000&#x27;, ..., &#x27;2049-12-31T23:30:00.000000000&#x27;,\n       &#x27;2049-12-31T23:45:00.000000000&#x27;, &#x27;2050-01-01T00:00:00.000000000&#x27;],\n      shape=(1051968,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>crs</span></div><div class='xr-var-dims'>(crs)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan</div><input id='attrs-50f20a59-2bee-4d66-b627-f6b38a376869' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-50f20a59-2bee-4d66-b627-f6b38a376869' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-66f8cbd9-6869-4a04-baf5-9bc1fec73775' class='xr-var-data-in' type='checkbox'><label for='data-66f8cbd9-6869-4a04-baf5-9bc1fec73775' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping_name :</span></dt><dd>healpix</dd><dt><span>healpix_nside :</span></dt><dd>64</dd><dt><span>healpix_order :</span></dt><dd>nest</dd></dl></div><div class='xr-var-data'><pre>array([nan], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-13307313-fd42-49ac-881a-dc2bd18fc34c' class='xr-section-summary-in' type='checkbox' checked /><label for='section-13307313-fd42-49ac-881a-dc2bd18fc34c' class='xr-section-summary' title='Expand/collapse section'>Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pr</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7d4de77f-0ee9-4c3a-8f01-a4b0e55e24f7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7d4de77f-0ee9-4c3a-8f01-a4b0e55e24f7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-287e659f-ac50-4928-9c3b-7705cdaea7d1' class='xr-var-data-in' type='checkbox'><label for='data-287e659f-ac50-4928-9c3b-7705cdaea7d1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>precipitation flux</dd><dt><span>units :</span></dt><dd>kg m-2 s-1</dd><dt><span>vgrid :</span></dt><dd>surface</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>qv2m</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0a2e58ad-a304-4dc9-ab91-effcbf971b8f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0a2e58ad-a304-4dc9-ab91-effcbf971b8f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b84eec9b-c651-435d-b810-f0f30b8b8630' class='xr-var-data-in' type='checkbox'><label for='data-b84eec9b-c651-435d-b810-f0f30b8b8630' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>specific humidity in 2m</dd><dt><span>units :</span></dt><dd>kg kg-1</dd><dt><span>vgrid :</span></dt><dd>height_2m</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rlut</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5e9890d7-5c10-4a75-ba0d-8d4b594c24b5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5e9890d7-5c10-4a75-ba0d-8d4b594c24b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-919a1d5a-725c-4b3a-ba4b-607fc0110e97' class='xr-var-data-in' type='checkbox'><label for='data-919a1d5a-725c-4b3a-ba4b-607fc0110e97' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>toa outgoing longwave radiation</dd><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>vgrid :</span></dt><dd>toa</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rsds</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-12f21208-91fe-402a-a809-2f6f43b2a01d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-12f21208-91fe-402a-a809-2f6f43b2a01d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1cfd4229-2287-4ba0-bd9e-ebf89014c7e7' class='xr-var-data-in' type='checkbox'><label for='data-1cfd4229-2287-4ba0-bd9e-ebf89014c7e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>surface downwelling shortwave radiation</dd><dt><span>standard_name :</span></dt><dd>surface_downwelling_shortwave_flux_in_air</dd><dt><span>units :</span></dt><dd>W m-2</dd><dt><span>vgrid :</span></dt><dd>surface</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sfcwind</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-9f1ef965-8113-4b07-98ea-120cbe52c1f8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9f1ef965-8113-4b07-98ea-120cbe52c1f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-029bd64b-5fea-4ed1-9e89-a2f47e773c52' class='xr-var-data-in' type='checkbox'><label for='data-029bd64b-5fea-4ed1-9e89-a2f47e773c52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>10m windspeed</dd><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>vgrid :</span></dt><dd>height_10m</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(time, cell)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-aa1649bf-a2c8-4354-b5ad-1cc80ade5bb4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aa1649bf-a2c8-4354-b5ad-1cc80ade5bb4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-434c128a-4838-43b1-bf08-a020a4b0b77c' class='xr-var-data-in' type='checkbox'><label for='data-434c128a-4838-43b1-bf08-a020a4b0b77c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean cell: mean</dd><dt><span>component :</span></dt><dd>atmo</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>temperature in 2m</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>vgrid :</span></dt><dd>height_2m</dd></dl></div><div class='xr-var-data'><pre>[51706331136 values with dtype=float32]</pre></div></li></ul></div></li></ul></div></div>","content_type":"text/html"}}},"key":"oLnFsBsQed"}],"key":"AkukiNHCmR"}],"key":"TdhAYbwpD0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HEALPix basic stats with the","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kv2xODAVsA"},{"type":"inlineCode","value":"healpix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mLrXmjrkx9"},{"type":"text","value":" package","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KV3ll7CeKq"}],"identifier":"healpix-basic-stats-with-thehealpix-package","label":"HEALPix basic stats with thehealpix package","html_id":"healpix-basic-stats-with-thehealpix-package","implicit":true,"key":"rBpO1yC3rp"}],"key":"YCg7WTis5Q"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let us look at the global and Boulder, CO, USA temperature averages for a 3-year time-slice of the whole dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HdSdnVMTHx"}],"key":"R2vgZfQjQe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this, we will first need to define a few HEALPix helper functions to get the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vzEnQyBa8g"},{"type":"inlineCode","value":"nest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qu4jhHU6r9"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KvRijX6a8G"},{"type":"inlineCode","value":"nside","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h7PzKeQXOb"},{"type":"text","value":" values from the dataset, then find the HEALPix pixel that Boulder coords fall in, and finally plot those temporal averages using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jRQP2IhP3j"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UxpICi8sFv"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zVuFaHZw4C"}],"key":"WBi1QLEOfy"}],"key":"OOohyOB0WJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import healpix as hp\nimport matplotlib.pylab as plt","key":"OLyxeKgFDO"},{"type":"outputs","id":"rw9BOTIMOq7TMOvFVLXKw","children":[],"key":"mDADdwOv2L"}],"key":"udeTEkIQxt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HEALPix helper functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hk06dhNS1i"}],"identifier":"healpix-helper-functions","label":"HEALPix helper functions","html_id":"healpix-helper-functions","implicit":true,"key":"KBiUxyh04K"}],"key":"qqtG0yQFtL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def get_nest(ds):\n    return ds.crs.healpix_order == \"nest\"\n    \ndef get_nside(ds):\n    return ds.crs.healpix_nside","key":"Yyag6G3PtQ"},{"type":"outputs","id":"1r5zAzEfLIFFZrFGDTCrV","children":[],"key":"X6ZeoROSJb"}],"key":"g6t81sgysI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HEALPix pixel containing Boulder‚Äôs coords","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"llXxHnhVEK"}],"identifier":"healpix-pixel-containing-boulders-coords","label":"HEALPix pixel containing Boulder‚Äôs coords","html_id":"healpix-pixel-containing-boulders-coords","implicit":true,"key":"Mnhq5KX8EE"}],"key":"HbRj58DCop"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nboulder_lon = -105.2747\nboulder_lat = 40.0190\n\nboulder_pixel = hp.ang2pix(\n    get_nside(ds_fine), boulder_lon, boulder_lat, lonlat=True, nest=get_nest(ds_fine)\n)","key":"Zx3ga1XvCs"},{"type":"outputs","id":"wPgOlRliPGC31JaIj_KUM","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"CPU times: user 311 Œºs, sys: 79 Œºs, total: 390 Œºs\nWall time: 400 Œºs\n"},"key":"x7XdrlokHV"}],"key":"veQqITvoZB"}],"key":"M4QJfTljBK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Global and Boulder‚Äôs temperature averages","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PC6TekGrcH"}],"identifier":"global-and-boulders-temperature-averages","label":"Global and Boulder‚Äôs temperature averages","html_id":"global-and-boulders-temperature-averages","implicit":true,"key":"qHWcWMPz2y"}],"key":"gbR6trWnub"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\ntime_slice = slice(\"2020-01-02T00:00:00.000000000\", \"2023-01-01T00:00:00.000000000\")\n\nds_fine.tas.sel(time=time_slice).isel(cell=boulder_pixel).plot(label=\"Boulder\")\n\nds_coarsest.tas.sel(time=time_slice).mean(\"cell\").plot(label=\"Global mean\")\n\nplt.legend()","key":"e3EqGH3XE8"},{"type":"outputs","id":"1McuPjSJa0CaFDncz7XVS","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"CPU times: user 306 ms, sys: 186 ms, total: 492 ms\nWall time: 1.88 s\n"},"key":"rK0Rvrwgw6"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"fed2c2a5019ef250662454cf650d8d2c","path":"/healpix-cookbook/build/fed2c2a5019ef250662454cf650d8d2c.png"}}},"key":"N4UkIfMRRb"}],"key":"IOUu1EKxEM"}],"key":"ACxupUILCY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting with easy.gems and cartopy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E3ITjn6Nh9"}],"identifier":"plotting-with-easy-gems-and-cartopy","label":"Plotting with easy.gems and cartopy","html_id":"plotting-with-easy-gems-and-cartopy","implicit":true,"key":"b6V2KXvsRt"}],"key":"vIrRluYPkN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this part, we will look at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cyyo9CVQZD"},{"type":"inlineCode","value":" healpix_show","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ogCzHq9nHD"},{"type":"text","value":" function that is provided by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qGZub6aE4P"},{"type":"inlineCode","value":"easy.gems","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d0nQH0KZ03"},{"type":"text","value":" for convenient HEALPix plotting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mdxe78TtkY"}],"key":"xa1eA3OfMI"}],"key":"Ag82nGAyR5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import easygems.healpix as eghp\n\nimport cartopy.crs as ccrs\nimport cartopy.feature as cf\nimport cmocean","key":"vWMM87Zn9O"},{"type":"outputs","id":"7iTU6tZoFG2d139t8D8is","children":[],"key":"PEkIeh0dN1"}],"key":"bWyByZ0vbB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Global plots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eEscvToSeP"}],"identifier":"global-plots","label":"Global plots","html_id":"global-plots","implicit":true,"key":"tgpjgrZ04Q"}],"key":"pGih3aYe3C"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Most of this is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GnPNqyeYRa"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uXH9FCIKgw"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N4YHlijhe9"},{"type":"inlineCode","value":"cartopy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LlasqUa9Mq"},{"type":"text","value":" code, but have a look at how ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rXM9STMw2S"},{"type":"inlineCode","value":"eghp.healpix_show()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fgJ36Nzbu2"},{"type":"text","value":" is called. The following code will plot global temperature (at the first timestep for simplicity)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lCsyULH5GW"}],"key":"rrKzdnhjH0"}],"key":"oeImrZc7QB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"projection = ccrs.Robinson(central_longitude=-135.5808361)\n\nfig, ax = plt.subplots(\n    figsize=(8, 4), subplot_kw={\"projection\": projection}, constrained_layout=True\n)\n\nax.set_global()\n\neghp.healpix_show(ds_fine.tas.isel(time=0), ax=ax, cmap=cmocean.cm.thermal)\n\nax.add_feature(cf.COASTLINE, linewidth=0.8)\nax.add_feature(cf.BORDERS, linewidth=0.4)","key":"UcuV2trEDt"},{"type":"outputs","id":"OPTJucl_ZpmcG_d0AUDHO","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mKeyError\u001b[39m                                  Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[10]\u001b[39m\u001b[32m, line 9\u001b[39m\n\u001b[32m      3\u001b[39m fig, ax = plt.subplots(\n\u001b[32m      4\u001b[39m     figsize=(\u001b[32m8\u001b[39m, \u001b[32m4\u001b[39m), subplot_kw={\u001b[33m\"\u001b[39m\u001b[33mprojection\u001b[39m\u001b[33m\"\u001b[39m: projection}, constrained_layout=\u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[32m      5\u001b[39m )\n\u001b[32m      7\u001b[39m ax.set_global()\n\u001b[32m----> \u001b[39m\u001b[32m9\u001b[39m \u001b[43meghp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mhealpix_show\u001b[49m\u001b[43m(\u001b[49m\u001b[43mds_fine\u001b[49m\u001b[43m.\u001b[49m\u001b[43mtas\u001b[49m\u001b[43m.\u001b[49m\u001b[43misel\u001b[49m\u001b[43m(\u001b[49m\u001b[43mtime\u001b[49m\u001b[43m=\u001b[49m\u001b[32;43m0\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43max\u001b[49m\u001b[43m=\u001b[49m\u001b[43max\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mcmap\u001b[49m\u001b[43m=\u001b[49m\u001b[43mcmocean\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcm\u001b[49m\u001b[43m.\u001b[49m\u001b[43mthermal\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     11\u001b[39m ax.add_feature(cf.COASTLINE, linewidth=\u001b[32m0.8\u001b[39m)\n\u001b[32m     12\u001b[39m ax.add_feature(cf.BORDERS, linewidth=\u001b[32m0.4\u001b[39m)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/easygems/healpix/__init__.py:172\u001b[39m, in \u001b[36mhealpix_show\u001b[39m\u001b[34m(var, method, nest, **kwargs)\u001b[39m\n\u001b[32m    171\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mhealpix_show\u001b[39m(var, method=\u001b[33m\"\u001b[39m\u001b[33mnearest\u001b[39m\u001b[33m\"\u001b[39m, nest=\u001b[38;5;28;01mTrue\u001b[39;00m, **kwargs):\n\u001b[32m--> \u001b[39m\u001b[32m172\u001b[39m     r = HEALPixResampler(nside=\u001b[43mget_nside\u001b[49m\u001b[43m(\u001b[49m\u001b[43mvar\u001b[49m\u001b[43m)\u001b[49m, nest=nest, method=method)\n\u001b[32m    174\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m map_show(var, resampler=r, **kwargs)\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/easygems/healpix/__init__.py:27\u001b[39m, in \u001b[36mget_nside\u001b[39m\u001b[34m(dx)\u001b[39m\n\u001b[32m     25\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mget_nside\u001b[39m(dx):\n\u001b[32m     26\u001b[39m     \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m---> \u001b[39m\u001b[32m27\u001b[39m         grid_mapping = \u001b[43mdx\u001b[49m\u001b[43m.\u001b[49m\u001b[43mcf\u001b[49m\u001b[43m[\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mgrid_mapping\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m]\u001b[49m\n\u001b[32m     28\u001b[39m     \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mAttributeError\u001b[39;00m:\n\u001b[32m     29\u001b[39m         \u001b[38;5;28;01mif\u001b[39;00m dx.squeeze().ndim > \u001b[32m1\u001b[39m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/cf_xarray/accessor.py:3406\u001b[39m, in \u001b[36mCFDataArrayAccessor.__getitem__\u001b[39m\u001b[34m(self, key)\u001b[39m\n\u001b[32m   3401\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(key, Hashable):\n\u001b[32m   3402\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\n\u001b[32m   3403\u001b[39m         \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mCannot use an Iterable of keys with DataArrays. Expected a single string. Received \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mkey\u001b[38;5;132;01m!r}\u001b[39;00m\u001b[33m instead.\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m   3404\u001b[39m     )\n\u001b[32m-> \u001b[39m\u001b[32m3406\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43m_getitem\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mkey\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/healpix-cookbook-dev/lib/python3.13/site-packages/cf_xarray/accessor.py:1241\u001b[39m, in \u001b[36m_getitem\u001b[39m\u001b[34m(accessor, key, skip)\u001b[39m\n\u001b[32m   1238\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m ds.set_coords(coords)\n\u001b[32m   1240\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m:\n\u001b[32m-> \u001b[39m\u001b[32m1241\u001b[39m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\n\u001b[32m   1242\u001b[39m         \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mkind\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m.cf does not understand the key \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mk\u001b[38;5;132;01m!r}\u001b[39;00m\u001b[33m. \u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m   1243\u001b[39m         \u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mUse \u001b[39m\u001b[33m'\u001b[39m\u001b[33mrepr(\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mkind\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m.cf)\u001b[39m\u001b[33m'\u001b[39m\u001b[33m (or \u001b[39m\u001b[33m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mkind\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m.cf\u001b[39m\u001b[33m'\u001b[39m\u001b[33m in a Jupyter environment) to see a list of key names that can be interpreted.\u001b[39m\u001b[33m\"\u001b[39m\n\u001b[32m   1244\u001b[39m     ) \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m\n\n\u001b[31mKeyError\u001b[39m: \"DataArray.cf does not understand the key 'grid_mapping'. Use 'repr(DataArray.cf)' (or 'DataArray.cf' in a Jupyter environment) to see a list of key names that can be interpreted.\"","ename":"KeyError","evalue":"\"DataArray.cf does not understand the key 'grid_mapping'. Use 'repr(DataArray.cf)' (or 'DataArray.cf' in a Jupyter environment) to see a list of key names that can be interpreted.\""},"key":"OSgLYxI7Ml"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a6c1c1226a9cab95a1ad6be1482c2d64","path":"/healpix-cookbook/build/a6c1c1226a9cab95a1ad6be1482c2d64.png"}}},"key":"EcK74OP7KL"}],"key":"QuOJO2kCeo"}],"key":"NHkY7uf5kd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Regional plots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KvK5Ydx4vs"}],"identifier":"regional-plots","label":"Regional plots","html_id":"regional-plots","implicit":true,"key":"IQLMRAkhpq"}],"key":"EhBhqyaWig"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If plotting a region of interest is desired, it is also possible through setting extents of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tZ7fLz36qo"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lqkTANVNOZ"},{"type":"text","value":" plot.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M6HqfDWx4w"}],"key":"rTxYzaYk4h"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let us look into USA map using the Boulder, CO, USA coords we had used before for simplicity:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TKDPSovJmD"}],"key":"J2LlRyLehq"}],"key":"MNLTJv0O7L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"projection = ccrs.Robinson(central_longitude=boulder_lon)\n\nfig, ax = plt.subplots(\n    figsize=(8, 4), subplot_kw={\"projection\": projection}, constrained_layout=True\n)\nax.set_extent([boulder_lon-20, boulder_lon+40, boulder_lat-20, boulder_lat+10], crs=ccrs.PlateCarree())\n\neghp.healpix_show(ds_fine.tas.isel(time=0), ax=ax, cmap=cmocean.cm.thermal)\n\nax.add_feature(cf.COASTLINE, linewidth=0.8)\nax.add_feature(cf.BORDERS, linewidth=0.4)","key":"QYOHqBks8y"},{"type":"outputs","id":"5KWWJft1I8My4Bg6m59C3","children":[],"key":"xPcBVKmJGs"}],"key":"V7C8LMwiOv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Further ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AFgPMvpasC"},{"type":"inlineCode","value":"easy.gems","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ogsMX4finE"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZuY0HQFFOR"},{"type":"inlineCode","value":"healpix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oRHbYWzBqU"}],"identifier":"further-easy-gems-and-healpix","label":"Further easy.gems and healpix","html_id":"further-easy-gems-and-healpix","implicit":true,"key":"NE0K7YcmBY"}],"key":"Xi3s6yFb4C"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"These are only a sampling of HEALPix and easy.gems capabilities; if you are interested in learning more, be sure to check out the usage examples at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MqSBr9FXT3"},{"type":"link","url":"https://easy.gems.dkrz.de/Processing/healpix/index.html#","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"easy.gems HEALPix Documentation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D2MtokUmpw"}],"urlSource":"https://easy.gems.dkrz.de/Processing/healpix/index.html#","key":"FqId7JAXSv"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eHAUCs0xcn"}],"key":"zYtxwduHlP"}],"key":"XWWgfJQ7hr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What is next?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QDiTBla21o"}],"identifier":"what-is-next","label":"What is next?","html_id":"what-is-next","implicit":true,"key":"bM1bb5KENv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ok2zgDqgs7"},{"type":"link","url":"/notebooks/uxarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"next section","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UzgUgWvKHx"}],"urlSource":"02-uxarray","dataUrl":"/notebooks.uxarray.json","internal":true,"protocol":"file","key":"wt9hEp18ve"},{"type":"text","value":" will provide an UXarray workflow that loads in and analyzes & visualizes HEALPix data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZUlYvXoSCc"}],"key":"rB7Ebm8lcy"}],"key":"L9qvWDtaVv"}],"key":"T6zeye3RHy"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"HEALPix Overview","url":"/notebooks/healpix","group":"Introduction to HEALPix"},"next":{"title":"UXarray for Basic HEALPix Statistics & Visualization","url":"/notebooks/uxarray","group":"HEALPix Analysis & Visualization"}}},"domain":"http://localhost:3000"}